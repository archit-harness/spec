title: Registry
description: Registry provides container registry details.
type: object
properties:
  connector:
    oneOf:
    - type: string
    - type: array
      items:
        oneOf:
        - type: object
          $ref: "./registry_conn.yaml"
        - type: string
    - type: object
      $ref: "./registry_conn.yaml"
  mirror:
    oneOf:
    - type: string
    - type: array
      items:
        type: string

# skip and manually create go file
x-go-skip: true

# example pipelines that demonstrate registry
# credential usage.
examples:
  # example global registry credential (one)
  - version: 1
    stages:
      - name: build
        type: ci
        spec:
          steps:
            - name: compile
              type: script
              image: golang
              spec:
                run: go build
    options:
      registry:
        connector: connector.dockerhub

  # example global registry credentials (multiple)
  - version: 1
    stages:
      - name: build
        type: ci
        spec:
          steps:
            - name: compile
              type: script
              image: golang
              spec:
                run: go build
    options:
      registry:
        connector:
        - connector.dockerhub
        - connector.gcr
  
  # example global registry credentials when
  # we need to help the system match the connector
  # with the correct registry domain name.
  - version: 1
    stages:
      - name: build
        type: ci
        spec:
          steps:
            - name: compile
              type: script
              image: us.gcr.io/account/project/golang:latest
              spec:
                run: go build
    options:
      registry:
        connector:
        - name: connector.dockerhub
        - name: connector.gcr
          match: us.gcr.io

  # example global registry mirror
  - version: 1
    stages:
      - name: build
        type: ci
        spec:
          steps:
            - name: compile
              type: script
              image: us.gcr.io/account/project/golang:latest
              spec:
                run: go build
    options:
      registry:
        mirror: mirror.gcr.io

  # example global registry mirrors
  - version: 1
    stages:
      - name: build
        type: ci
        spec:
          steps:
            - name: compile
              type: script
              image: us.gcr.io/account/project/golang:latest
              spec:
                run: go build
    options:
      registry:
        mirror:
        - mirror.gcr.io
        - mirror.harness.io
